2024-11-17:14:25:27 [INFO    ] [ft.py:170] {'amp': True,
 'batch_size': 128,
 'checkpoint_load': None,
 'checkpoint_save': 'record/sig_0_1_ViT/defense/ft/checkpoint/',
 'client_optimizer': 'AdamW',
 'dataset': 'cifar10',
 'dataset_path': './data/cifar10',
 'device': 'cuda:0',
 'epochs': 20,
 'frequency_save': 0,
 'img_size': (32, 32, 3),
 'index': None,
 'input_channel': 3,
 'input_height': 32,
 'input_width': 32,
 'log': 'record/sig_0_1_ViT/defense/ft/log/',
 'lr': 0.0001,
 'lr_scheduler': 'CosineAnnealingLR',
 'model': 'vit_b_16',
 'non_blocking': True,
 'num_classes': 10,
 'num_workers': 4,
 'pin_memory': True,
 'prefetch': False,
 'random_seed': 0,
 'ratio': 0.05,
 'result_file': 'sig_0_1_ViT',
 'save_path': 'record/sig_0_1_ViT/defense/ft/',
 'sgd_momentum': 0.75,
 'terminal_info': ['./defense/ft.py',
                   '--result_file',
                   'sig_0_1_ViT',
                   '--yaml_path',
                   './config-vit/defense/ft/cifar10.yaml',
                   '--dataset',
                   'cifar10',
                   '--epochs',
                   '20',
                   '--ratio',
                   '0.05',
                   '--device',
                   'cuda:0',
                   '--model',
                   'vit_b_16'],
 'wd': 0.0005,
 'yaml_path': './config-vit/defense/ft/cifar10.yaml'}
2024-11-17:14:25:27 [INFO    ] [ft.py:173] {'git hash': None,
 'last 3 log': 'commit f2ca5f8f4b58e07a407dd65ca217f11673aba63d\n'
               'Author: soheilzi <soheil.zibakhsh@gmail.com>\n'
               'Date:   Tue Nov 12 09:46:15 2024 -0800\n'
               '\n'
               '    added the adverserial test, added the trojan tests with '
               'MG\n'
               '\n'
               'commit afd704e7564791ddc0ae120c7d2e1581bd3a4f80\n'
               'Author: Yaman <yamanjandali@gmail.com>\n'
               'Date:   Fri Nov 8 16:15:34 2024 -0800\n'
               '\n'
               '    removed added files\n'
               '\n'
               'commit 9bc0c704e4be5beff4562e38a15f0b4e070bb433\n'
               'Author: Yaman <yamanjandali@gmail.com>\n'
               'Date:   Tue Nov 5 10:24:03 2024 -0800\n'
               '\n'
               '    updated train_settings_generate.py file',
 'status': 'On branch main\n'
           "Your branch is up to date with 'origin/main'.\n"
           '\n'
           'Changes not staged for commit:\n'
           '  (use "git add <file>..." to update what will be committed)\n'
           '  (use "git restore <file>..." to discard changes in working '
           'directory)\n'
           '\tmodified:   attack/trojannn.py\n'
           '\tmodified:   config/attack/badnet/default.yaml\n'
           '\tmodified:   config/attack/trojannn/vit_b_16.yaml\n'
           '\tmodified:   config/attack/wanet/default.yaml\n'
           '\tmodified:   config/defense/ft-sam/cifar10.yaml\n'
           '\tmodified:   testing_adverserial/adverserial_test.ipynb\n'
           '\n'
           'Untracked files:\n'
           '  (use "git add <file>..." to include in what will be committed)\n'
           '\tattackOut.txt\n'
           '\tconfig-vit/\n'
           '\toutputPane.txt\n'
           '\toutputPaneWaNet.txt\n'
           '\trecord/badnet_0_1_RN18/\n'
           '\trecord/badnet_0_1_ViT/\n'
           '\trecord/blended_0_1_RN18/\n'
           '\trecord/blended_0_1_ViT/\n'
           '\trecord/inputaware_0_1_RN18FR/\n'
           '\trecord/inputaware_0_1_ViT/\n'
           '\trecord/sig_0_1_RN18FR/\n'
           '\trecord/sig_0_1_ViT/\n'
           '\trecord/sig_0_1_ViTOG/\n'
           '\trecord/trojannn_0_1_RN18/\n'
           '\trecord/trojannn_0_1_ViT2/\n'
           '\trecord/wanet_0_1_RN18/\n'
           '\trecord/wanet_0_1_ViT/\n'
           '\tresource/clean_model/\n'
           '\trun_attacks.sh\n'
           '\trun_attacks2.sh\n'
           '\trun_attacksRN18.sh\n'
           '\trun_attacks_ViT.sh\n'
           '\trun_defenses.sh\n'
           '\trun_defensesRN18.sh\n'
           '\ttesting_adverserial/adverserial_test2.ipynb\n'
           '\n'
           'no changes added to commit (use "git add" and/or "git commit -a")'}
2024-11-17:14:25:29 [INFO    ] [bd_dataset_v2.py:133] save file format is .png
2024-11-17:14:25:29 [INFO    ] [trainer_cls.py:972] Do NOT set the settings/parameters attr manually after you start training!
You may break the relationship between them.
2024-11-17:14:25:29 [INFO    ] [trainer_cls.py:1030] ('epoch_now:0, '
 'batch_now:0self.amp:True,self.criterion:CrossEntropyLoss(),self.optimizer:AdamW '
 '(\n'
 'Parameter Group 0\n'
 '    amsgrad: False\n'
 '    betas: (0.9, 0.999)\n'
 '    capturable: False\n'
 '    differentiable: False\n'
 '    eps: 1e-08\n'
 '    foreach: None\n'
 '    fused: None\n'
 '    initial_lr: 0.0001\n'
 '    lr: 0.0001\n'
 '    maximize: False\n'
 '    weight_decay: 0.01\n'
 "),self.scheduler:{'T_max': 100, 'eta_min': 0, 'base_lrs': [0.0001], "
 "'last_epoch': 0, 'verbose': False, '_step_count': 1, "
 "'_get_lr_called_within_step': False, '_last_lr': "
 "[0.0001]},self.scaler:{'scale': 65536.0, 'growth_factor': 2.0, "
 "'backoff_factor': 0.5, 'growth_interval': 2000, '_growth_tracker': 0})")
2024-11-17:14:25:36 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.8038718700408936 s
2024-11-17:14:26:22 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 4.874912564183624,
 'clean_test_loss_avg_over_batch': 0.1576058614433189,
 'epoch': 0,
 'test_acc': 0.9505,
 'test_asr': 0.21333333333333335,
 'test_ra': 0.7232222222222222,
 'train_acc': 0.9564,
 'train_epoch_loss_avg_over_batch': 0.18180970884859562}
2024-11-17:14:26:28 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.902485132217407 s
2024-11-17:14:27:15 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.34367891096733,
 'clean_test_loss_avg_over_batch': 0.1710520012280609,
 'epoch': 1,
 'test_acc': 0.952,
 'test_asr': 0.17777777777777778,
 'test_ra': 0.7502222222222222,
 'train_acc': 0.9896,
 'train_epoch_loss_avg_over_batch': 0.02713438094360754}
2024-11-17:14:27:21 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.959482669830322 s
2024-11-17:14:28:08 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.339697562472921,
 'clean_test_loss_avg_over_batch': 0.1531450324161332,
 'epoch': 2,
 'test_acc': 0.9584,
 'test_asr': 0.13433333333333333,
 'test_ra': 0.7758888888888889,
 'train_acc': 0.9976,
 'train_epoch_loss_avg_over_batch': 0.010518207144923509}
2024-11-17:14:28:14 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.96409010887146 s
2024-11-17:14:29:01 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.877143644950759,
 'clean_test_loss_avg_over_batch': 0.16210545221037126,
 'epoch': 3,
 'test_acc': 0.9572,
 'test_asr': 0.16477777777777777,
 'test_ra': 0.766,
 'train_acc': 0.998,
 'train_epoch_loss_avg_over_batch': 0.007944910041987895}
2024-11-17:14:29:08 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.9431915283203125 s
2024-11-17:14:29:55 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.9089165674129,
 'clean_test_loss_avg_over_batch': 0.15840681649367266,
 'epoch': 4,
 'test_acc': 0.9573,
 'test_asr': 0.17655555555555555,
 'test_ra': 0.7312222222222222,
 'train_acc': 0.998,
 'train_epoch_loss_avg_over_batch': 0.004193220584420487}
2024-11-17:14:30:01 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.9283294677734375 s
2024-11-17:14:30:48 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.132912125385983,
 'clean_test_loss_avg_over_batch': 0.15211662937757336,
 'epoch': 5,
 'test_acc': 0.9603,
 'test_asr': 0.17022222222222222,
 'test_ra': 0.7408888888888889,
 'train_acc': 0.9988,
 'train_epoch_loss_avg_over_batch': 0.004407223366433755}
2024-11-17:14:30:54 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.931003570556641 s
2024-11-17:14:31:41 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.028452893378029,
 'clean_test_loss_avg_over_batch': 0.1738184193927276,
 'epoch': 6,
 'test_acc': 0.9555,
 'test_asr': 0.19044444444444444,
 'test_ra': 0.7356666666666667,
 'train_acc': 1.0,
 'train_epoch_loss_avg_over_batch': 0.002303195418789983}
2024-11-17:14:31:47 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.931683540344238 s
2024-11-17:14:32:34 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.227908550853461,
 'clean_test_loss_avg_over_batch': 0.18057535562216293,
 'epoch': 7,
 'test_acc': 0.9546,
 'test_asr': 0.187,
 'test_ra': 0.7355555555555555,
 'train_acc': 1.0,
 'train_epoch_loss_avg_over_batch': 0.0018398057552985847}
2024-11-17:14:32:41 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.91616678237915 s
2024-11-17:14:33:28 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 7.013532873610376,
 'clean_test_loss_avg_over_batch': 0.17161128075816964,
 'epoch': 8,
 'test_acc': 0.9596,
 'test_asr': 0.14055555555555554,
 'test_ra': 0.7678888888888888,
 'train_acc': 1.0,
 'train_epoch_loss_avg_over_batch': 0.0011703355703502893}
2024-11-17:14:33:34 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.912307262420654 s
2024-11-17:14:34:21 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.220684058229688,
 'clean_test_loss_avg_over_batch': 0.21267960272446462,
 'epoch': 9,
 'test_acc': 0.9496,
 'test_asr': 0.19088888888888889,
 'test_ra': 0.7178888888888889,
 'train_acc': 0.998,
 'train_epoch_loss_avg_over_batch': 0.005753720132634044}
2024-11-17:14:34:27 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.919081926345825 s
2024-11-17:14:35:14 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 4.588137499043639,
 'clean_test_loss_avg_over_batch': 0.24598371921272216,
 'epoch': 10,
 'test_acc': 0.9388,
 'test_asr': 0.3032222222222222,
 'test_ra': 0.6108888888888889,
 'train_acc': 0.9952,
 'train_epoch_loss_avg_over_batch': 0.018304307572543622}
2024-11-17:14:35:20 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.924277305603027 s
2024-11-17:14:36:07 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.122547451878937,
 'clean_test_loss_avg_over_batch': 0.21256515202171442,
 'epoch': 11,
 'test_acc': 0.9444,
 'test_asr': 0.19133333333333333,
 'test_ra': 0.7251111111111112,
 'train_acc': 0.9944,
 'train_epoch_loss_avg_over_batch': 0.018393395096063615}
2024-11-17:14:36:13 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.9277729988098145 s
2024-11-17:14:37:00 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.3821464860943005,
 'clean_test_loss_avg_over_batch': 0.20707842450636096,
 'epoch': 12,
 'test_acc': 0.9485,
 'test_asr': 0.25066666666666665,
 'test_ra': 0.6444444444444445,
 'train_acc': 0.9972,
 'train_epoch_loss_avg_over_batch': 0.011603837518487125}
2024-11-17:14:37:06 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.9169228076934814 s
2024-11-17:14:37:54 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.800144047804282,
 'clean_test_loss_avg_over_batch': 0.20516833520341146,
 'epoch': 13,
 'test_acc': 0.9475,
 'test_asr': 0.23666666666666666,
 'test_ra': 0.6813333333333333,
 'train_acc': 0.9984,
 'train_epoch_loss_avg_over_batch': 0.007727692322805524}
2024-11-17:14:38:00 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.918787240982056 s
2024-11-17:14:38:47 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.493346583675331,
 'clean_test_loss_avg_over_batch': 0.18656921306554275,
 'epoch': 14,
 'test_acc': 0.9525,
 'test_asr': 0.24,
 'test_ra': 0.6803333333333333,
 'train_acc': 0.9976,
 'train_epoch_loss_avg_over_batch': 0.00824298788793385}
2024-11-17:14:38:53 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.926666975021362 s
2024-11-17:14:39:40 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.317774336102983,
 'clean_test_loss_avg_over_batch': 0.21246520774674754,
 'epoch': 15,
 'test_acc': 0.9475,
 'test_asr': 0.27566666666666667,
 'test_ra': 0.6443333333333333,
 'train_acc': 0.9996,
 'train_epoch_loss_avg_over_batch': 0.003977365698665381}
2024-11-17:14:39:46 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.9174065589904785 s
2024-11-17:14:40:33 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.5866856910813025,
 'clean_test_loss_avg_over_batch': 0.19976984110625484,
 'epoch': 16,
 'test_acc': 0.9517,
 'test_asr': 0.25255555555555553,
 'test_ra': 0.6756666666666666,
 'train_acc': 0.9976,
 'train_epoch_loss_avg_over_batch': 0.00902357678860426}
2024-11-17:14:40:39 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.9042809009552 s
2024-11-17:14:41:26 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.94665647560442,
 'clean_test_loss_avg_over_batch': 0.23859149368503427,
 'epoch': 17,
 'test_acc': 0.9427,
 'test_asr': 0.22411111111111112,
 'test_ra': 0.6673333333333333,
 'train_acc': 0.998,
 'train_epoch_loss_avg_over_batch': 0.005799940624274314}
2024-11-17:14:41:33 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.9240288734436035 s
2024-11-17:14:42:20 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.0687795692766215,
 'clean_test_loss_avg_over_batch': 0.21888197967900505,
 'epoch': 18,
 'test_acc': 0.946,
 'test_asr': 0.3128888888888889,
 'test_ra': 0.6146666666666667,
 'train_acc': 0.9988,
 'train_epoch_loss_avg_over_batch': 0.0032972666958812624}
2024-11-17:14:42:26 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.927576303482056 s
2024-11-17:14:43:13 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 4.524579780202516,
 'clean_test_loss_avg_over_batch': 0.2284833872200821,
 'epoch': 19,
 'test_acc': 0.9461,
 'test_asr': 0.35933333333333334,
 'test_ra': 0.5735555555555556,
 'train_acc': 0.9996,
 'train_epoch_loss_avg_over_batch': 0.0017521773639600723}
2024-11-17:14:43:13 [INFO    ] [save_load_attack.py:176] saving...
