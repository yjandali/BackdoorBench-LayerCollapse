2024-11-15:06:26:00 [INFO    ] [ft.py:170] {'amp': True,
 'batch_size': 128,
 'checkpoint_load': None,
 'checkpoint_save': 'record/wanet_0_1_ViT/defense/ft/checkpoint/',
 'client_optimizer': 'AdamW',
 'dataset': 'cifar10',
 'dataset_path': './data/cifar10',
 'device': 'cuda:1',
 'epochs': 20,
 'frequency_save': 0,
 'img_size': (32, 32, 3),
 'index': None,
 'input_channel': 3,
 'input_height': 32,
 'input_width': 32,
 'log': 'record/wanet_0_1_ViT/defense/ft/log/',
 'lr': 0.0001,
 'lr_scheduler': 'CosineAnnealingLR',
 'model': 'vit_b_16',
 'non_blocking': True,
 'num_classes': 10,
 'num_workers': 4,
 'pin_memory': True,
 'prefetch': False,
 'random_seed': 0,
 'ratio': 0.05,
 'result_file': 'wanet_0_1_ViT',
 'save_path': 'record/wanet_0_1_ViT/defense/ft/',
 'sgd_momentum': 0.75,
 'terminal_info': ['./defense/ft.py',
                   '--result_file',
                   'wanet_0_1_ViT',
                   '--yaml_path',
                   './config-vit/defense/ft/cifar10.yaml',
                   '--dataset',
                   'cifar10',
                   '--epochs',
                   '20',
                   '--ratio',
                   '0.05',
                   '--device',
                   'cuda:1'],
 'wd': 0.0005,
 'yaml_path': './config-vit/defense/ft/cifar10.yaml'}
2024-11-15:06:26:00 [INFO    ] [ft.py:173] {'git hash': None,
 'last 3 log': 'commit f2ca5f8f4b58e07a407dd65ca217f11673aba63d\n'
               'Author: soheilzi <soheil.zibakhsh@gmail.com>\n'
               'Date:   Tue Nov 12 09:46:15 2024 -0800\n'
               '\n'
               '    added the adverserial test, added the trojan tests with '
               'MG\n'
               '\n'
               'commit afd704e7564791ddc0ae120c7d2e1581bd3a4f80\n'
               'Author: Yaman <yamanjandali@gmail.com>\n'
               'Date:   Fri Nov 8 16:15:34 2024 -0800\n'
               '\n'
               '    removed added files\n'
               '\n'
               'commit 9bc0c704e4be5beff4562e38a15f0b4e070bb433\n'
               'Author: Yaman <yamanjandali@gmail.com>\n'
               'Date:   Tue Nov 5 10:24:03 2024 -0800\n'
               '\n'
               '    updated train_settings_generate.py file',
 'status': 'On branch main\n'
           "Your branch is up to date with 'origin/main'.\n"
           '\n'
           'Changes not staged for commit:\n'
           '  (use "git add <file>..." to update what will be committed)\n'
           '  (use "git restore <file>..." to discard changes in working '
           'directory)\n'
           '\tmodified:   attack/trojannn.py\n'
           '\tmodified:   config/attack/badnet/default.yaml\n'
           '\tmodified:   config/attack/trojannn/vit_b_16.yaml\n'
           '\tmodified:   config/attack/wanet/default.yaml\n'
           '\tmodified:   testing_adverserial/adverserial_test.ipynb\n'
           '\n'
           'Untracked files:\n'
           '  (use "git add <file>..." to include in what will be committed)\n'
           '\tattackOut.txt\n'
           '\tconfig-vit/\n'
           '\trecord/badnet_0_1_ViT/\n'
           '\trecord/blended_0_1_ViT/\n'
           '\trecord/wanet_0_1_ViT/\n'
           '\tresource/clean_model/\n'
           '\trun_attacks.sh\n'
           '\trun_attacks2.sh\n'
           '\trun_defenses.sh\n'
           '\ttesting_adverserial/adverserial_test2.ipynb\n'
           '\n'
           'no changes added to commit (use "git add" and/or "git commit -a")'}
2024-11-15:06:26:02 [INFO    ] [bd_dataset_v2.py:133] save file format is .png
2024-11-15:06:26:02 [INFO    ] [trainer_cls.py:972] Do NOT set the settings/parameters attr manually after you start training!
You may break the relationship between them.
2024-11-15:06:26:02 [INFO    ] [trainer_cls.py:1030] ('epoch_now:0, '
 'batch_now:0self.amp:True,self.criterion:CrossEntropyLoss(),self.optimizer:AdamW '
 '(\n'
 'Parameter Group 0\n'
 '    amsgrad: False\n'
 '    betas: (0.9, 0.999)\n'
 '    capturable: False\n'
 '    differentiable: False\n'
 '    eps: 1e-08\n'
 '    foreach: None\n'
 '    fused: None\n'
 '    initial_lr: 0.0001\n'
 '    lr: 0.0001\n'
 '    maximize: False\n'
 '    weight_decay: 0.01\n'
 "),self.scheduler:{'T_max': 100, 'eta_min': 0, 'base_lrs': [0.0001], "
 "'last_epoch': 0, 'verbose': False, '_step_count': 1, "
 "'_get_lr_called_within_step': False, '_last_lr': "
 "[0.0001]},self.scaler:{'scale': 65536.0, 'growth_factor': 2.0, "
 "'backoff_factor': 0.5, 'growth_interval': 2000, '_growth_tracker': 0})")
2024-11-15:06:26:09 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.809291839599609 s
2024-11-15:06:26:54 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 8.385875191487058,
 'clean_test_loss_avg_over_batch': 0.18441580632064916,
 'epoch': 0,
 'test_acc': 0.9496,
 'test_asr': 0.004666666666666667,
 'test_ra': 0.9518888888888889,
 'train_acc': 0.9852,
 'train_epoch_loss_avg_over_batch': 0.04730410263873637}
2024-11-15:06:27:00 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.876728534698486 s
2024-11-15:06:27:47 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.825294131964025,
 'clean_test_loss_avg_over_batch': 0.12391791280500497,
 'epoch': 1,
 'test_acc': 0.9631,
 'test_asr': 0.006666666666666667,
 'test_ra': 0.9532222222222222,
 'train_acc': 0.988,
 'train_epoch_loss_avg_over_batch': 0.03770702154142782}
2024-11-15:06:27:54 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 5.965342044830322 s
2024-11-15:06:28:41 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.663376385057476,
 'clean_test_loss_avg_over_batch': 0.16034261585225032,
 'epoch': 2,
 'test_acc': 0.957,
 'test_asr': 0.0014444444444444444,
 'test_ra': 0.9537777777777777,
 'train_acc': 0.9948,
 'train_epoch_loss_avg_over_batch': 0.015071129938587547}
2024-11-15:06:28:47 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.021570444107056 s
2024-11-15:06:29:35 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.167113626506967,
 'clean_test_loss_avg_over_batch': 0.1293376739036669,
 'epoch': 3,
 'test_acc': 0.9646,
 'test_asr': 0.0047777777777777775,
 'test_ra': 0.9516666666666667,
 'train_acc': 0.996,
 'train_epoch_loss_avg_over_batch': 0.010471407417207956}
2024-11-15:06:29:41 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.045287609100342 s
2024-11-15:06:30:29 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 7.009632540420747,
 'clean_test_loss_avg_over_batch': 0.14101030397718137,
 'epoch': 4,
 'test_acc': 0.9625,
 'test_asr': 0.0044444444444444444,
 'test_ra': 0.9585555555555556,
 'train_acc': 0.9956,
 'train_epoch_loss_avg_over_batch': 0.0101511470915284}
2024-11-15:06:30:35 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.043658971786499 s
2024-11-15:06:31:23 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 7.021201321776484,
 'clean_test_loss_avg_over_batch': 0.14105813976530504,
 'epoch': 5,
 'test_acc': 0.9621,
 'test_asr': 0.003,
 'test_ra': 0.9555555555555556,
 'train_acc': 0.9968,
 'train_epoch_loss_avg_over_batch': 0.01313711132388562}
2024-11-15:06:31:29 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.03240966796875 s
2024-11-15:06:32:17 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 5.947678028697699,
 'clean_test_loss_avg_over_batch': 0.16833234106815315,
 'epoch': 6,
 'test_acc': 0.9575,
 'test_asr': 0.008444444444444444,
 'test_ra': 0.949,
 'train_acc': 0.9976,
 'train_epoch_loss_avg_over_batch': 0.008206815796438605}
2024-11-15:06:32:23 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.010011672973633 s
2024-11-15:06:33:10 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.384436614076856,
 'clean_test_loss_avg_over_batch': 0.19079495106139988,
 'epoch': 7,
 'test_acc': 0.9543,
 'test_asr': 0.004222222222222222,
 'test_ra': 0.9442222222222222,
 'train_acc': 0.9976,
 'train_epoch_loss_avg_over_batch': 0.0071076360996812585}
2024-11-15:06:33:17 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.000579118728638 s
2024-11-15:06:34:04 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.932864437640553,
 'clean_test_loss_avg_over_batch': 0.22976589811187756,
 'epoch': 8,
 'test_acc': 0.9411,
 'test_asr': 0.005666666666666667,
 'test_ra': 0.9268888888888889,
 'train_acc': 0.9928,
 'train_epoch_loss_avg_over_batch': 0.0170801225642208}
2024-11-15:06:34:10 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.016903638839722 s
2024-11-15:06:34:58 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.401628568138875,
 'clean_test_loss_avg_over_batch': 0.2070905516702163,
 'epoch': 9,
 'test_acc': 0.9515,
 'test_asr': 0.010333333333333333,
 'test_ra': 0.9344444444444444,
 'train_acc': 0.9948,
 'train_epoch_loss_avg_over_batch': 0.018727653380483388}
2024-11-15:06:35:04 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.020141839981079 s
2024-11-15:06:35:52 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.614720404987604,
 'clean_test_loss_avg_over_batch': 0.22882451246716554,
 'epoch': 10,
 'test_acc': 0.9442,
 'test_asr': 0.004111111111111111,
 'test_ra': 0.9307777777777778,
 'train_acc': 0.9928,
 'train_epoch_loss_avg_over_batch': 0.02528729985933751}
2024-11-15:06:35:58 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.018692255020142 s
2024-11-15:06:36:46 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.164868421957526,
 'clean_test_loss_avg_over_batch': 0.2297101838490631,
 'epoch': 11,
 'test_acc': 0.9414,
 'test_asr': 0.010222222222222223,
 'test_ra': 0.9283333333333333,
 'train_acc': 0.9924,
 'train_epoch_loss_avg_over_batch': 0.028741271793842317}
2024-11-15:06:36:52 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.015945911407471 s
2024-11-15:06:37:40 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.325962422599255,
 'clean_test_loss_avg_over_batch': 0.18578265211250208,
 'epoch': 12,
 'test_acc': 0.9521,
 'test_asr': 0.0054444444444444445,
 'test_ra': 0.9425555555555556,
 'train_acc': 0.994,
 'train_epoch_loss_avg_over_batch': 0.01821288364008069}
2024-11-15:06:37:46 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.013286352157593 s
2024-11-15:06:38:34 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.691331708934945,
 'clean_test_loss_avg_over_batch': 0.21820207043916365,
 'epoch': 13,
 'test_acc': 0.9414,
 'test_asr': 0.0015555555555555555,
 'test_ra': 0.9363333333333334,
 'train_acc': 0.9956,
 'train_epoch_loss_avg_over_batch': 0.013224853482097388}
2024-11-15:06:38:40 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.0262651443481445 s
2024-11-15:06:39:28 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.920039412001489,
 'clean_test_loss_avg_over_batch': 0.17143567921475897,
 'epoch': 14,
 'test_acc': 0.9551,
 'test_asr': 0.005666666666666667,
 'test_ra': 0.9453333333333334,
 'train_acc': 0.9956,
 'train_epoch_loss_avg_over_batch': 0.015431573474779725}
2024-11-15:06:39:34 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.035679817199707 s
2024-11-15:06:40:22 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.773234548703046,
 'clean_test_loss_avg_over_batch': 0.16160667034549803,
 'epoch': 15,
 'test_acc': 0.9565,
 'test_asr': 0.0047777777777777775,
 'test_ra': 0.9491111111111111,
 'train_acc': 0.9992,
 'train_epoch_loss_avg_over_batch': 0.0074717218085424975}
2024-11-15:06:40:28 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.0265960693359375 s
2024-11-15:06:41:16 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.389679270730892,
 'clean_test_loss_avg_over_batch': 0.16340174426949478,
 'epoch': 16,
 'test_acc': 0.9598,
 'test_asr': 0.004555555555555556,
 'test_ra': 0.9473333333333334,
 'train_acc': 0.9988,
 'train_epoch_loss_avg_over_batch': 0.0031101442873477936}
2024-11-15:06:41:22 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.0288050174713135 s
2024-11-15:06:42:10 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.056735032041308,
 'clean_test_loss_avg_over_batch': 0.21815741918037965,
 'epoch': 17,
 'test_acc': 0.9471,
 'test_asr': 0.007555555555555556,
 'test_ra': 0.9262222222222222,
 'train_acc': 0.9988,
 'train_epoch_loss_avg_over_batch': 0.0033312670595478265}
2024-11-15:06:42:16 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.239914655685425 s
2024-11-15:06:43:04 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.767074759577362,
 'clean_test_loss_avg_over_batch': 0.18849286088083364,
 'epoch': 18,
 'test_acc': 0.9537,
 'test_asr': 0.004666666666666667,
 'test_ra': 0.9445555555555556,
 'train_acc': 0.9988,
 'train_epoch_loss_avg_over_batch': 0.004606839828193187}
2024-11-15:06:43:10 [INFO    ] [trainer_cls.py:1489] one epoch training part done, use time = 6.0252227783203125 s
2024-11-15:06:43:58 [INFO    ] [trainer_cls.py:65] {'batch': 20,
 'bd_test_loss_avg_over_batch': 6.415538445324965,
 'clean_test_loss_avg_over_batch': 0.23051724889421765,
 'epoch': 19,
 'test_acc': 0.9456,
 'test_asr': 0.0071111111111111115,
 'test_ra': 0.9281111111111111,
 'train_acc': 0.9968,
 'train_epoch_loss_avg_over_batch': 0.007816108223050833}
2024-11-15:06:43:58 [INFO    ] [save_load_attack.py:176] saving...
